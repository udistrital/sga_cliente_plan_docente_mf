<mat-card>
    <mat-card-header>
        <mat-card-title>
            {{ 'ptd.preasignar_ptd' | translate }}
        </mat-card-title>
    </mat-card-header>
    <mat-card-content class="margin-y">
        <form novalidate [formGroup]="preasignacionForm" #fform="ngForm" class="form-horizontal">
            

                <div class="campos">
                    <div class="espacio">
                        <mat-form-field style="width: 65%;">
                            <mat-label>*{{ 'GLOBAL.tipo_vinculacion' | translate }}:</mat-label>
                            <mat-select formControlName="tipo_vinculacion">
                                <mat-option>--{{ 'GLOBAL.seleccionar' | translate }}--</mat-option>
                                <mat-option *ngFor="let item of tipoVinculacion" [value]="item.id">
                                    {{item.nombre}}
                                </mat-option>
                            </mat-select>
                            <mat-error
                                *ngIf="preasignacionForm.get('tipo_vinculacion')?.hasError('required') && preasignacionForm.get('tipo_vinculacion')?.touched">
                                {{ 'ptd.error_tipo_vinculacion' | translate }}
                            </mat-error>
                        </mat-form-field>

                        <mat-form-field style="width: 33%;">
                            <mat-label>*{{ 'GLOBAL.periodo' | translate }}:</mat-label>
                            <mat-select formControlName="periodo">
                                <mat-option>--{{ 'GLOBAL.seleccionar' | translate }}--</mat-option>
                                <mat-option *ngFor="let item of periodos" [value]="item">
                                    {{item.Nombre}}
                                </mat-option>
                            </mat-select>
                            <mat-error
                                *ngIf="preasignacionForm.get('periodo')?.hasError('required') && preasignacionForm.get('periodo')?.touched">
                                {{ 'ptd.error_periodo' | translate }}
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="espacio">
                        <mat-form-field style="width: 90%;">
                            <mat-label>{{ 'ptd.documento_docente' | translate }}</mat-label>
                            <input matInput type="text" formControlName="doc_docente" pattern="[0-9]*"
                                placeholder="*{{ 'ptd.documento_docente' | translate }}: " />
                            <mat-error
                                *ngIf="preasignacionForm.get('doc_docente')?.hasError('required') && preasignacionForm.get('doc_docente')?.touched">
                                {{ 'ptd.error_doc_docente' | translate }}
                            </mat-error>
                        </mat-form-field>

                        <button mat-raised-button color="primary" title="{{ 'GLOBAL.buscar' | translate }}" class="tam-boton"
                            (click)="buscarDocenteDocumento()">
                            <mat-icon class="escala-2_0" style="margin: 0;">search</mat-icon>
                        </button>
                    </div>
                    <mat-form-field style="width: 100%;">
                        <mat-label>*{{ 'ptd.nombre_docente' | translate }}:</mat-label>
                        <input matInput type="text" formControlName="docente" [matAutocomplete]="auto"
                            (keyup)="searchTerm$.next({text: event2text($event), field: fform.directives[3]})">
                        <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete"
                            (optionSelected)="setDocente($event)">
                            <mat-option *ngFor="let option of filteredDocentes | async" [value]="option">
                                {{option.Nombre}}
                            </mat-option>
                        </mat-autocomplete>
                        <mat-hint style="width: 100%;">
                            <div style="font-size: 13px;">
                                {{'ptd.placeholder_nombre_docente' | translate }}
                            </div>
                        </mat-hint>
                        <mat-error
                            *ngIf="preasignacionForm.get('docente')?.hasError('required') && preasignacionForm.get('docente')?.touched">
                            {{ 'ptd.error_docente' | translate }}
                        </mat-error>
                    </mat-form-field>
                    <div class="espacio">
                        <mat-form-field style="width: 90%;">
                            <mat-label>{{ 'ptd.codigo_espacio_academico' | translate }}</mat-label>
                            <input matInput type="text" formControlName="codigo"
                                placeholder="*{{ 'ptd.codigo_espacio_academico' | translate }}: " />
                            <mat-error
                                *ngIf="preasignacionForm.get('codigo')?.hasError('required') && preasignacionForm.get('codigo')?.touched">
                                {{ 'ptd.error_espacio_academico' | translate }}
                            </mat-error>
                        </mat-form-field>

                        <button mat-raised-button color="primary" title="{{ 'GLOBAL.buscar' | translate }}"
                            (click)="buscarEspacioAcademico()">
                            <mat-icon class="escala-2_0" style="margin: 0;">search</mat-icon>
                        </button>
                    </div>
                    <mat-form-field style="width: 100%;">
                        <mat-label>*{{ 'ptd.espacio_academico' | translate }}:</mat-label>
                        <mat-select formControlName="espacio_academico" (selectionChange)="loadProyectos()">
                            <mat-option>--{{ 'GLOBAL.seleccionar' | translate }}--</mat-option>
                            <mat-option *ngFor="let item of opcionesEspaciosAcademicos" [value]="item">
                                {{item.nombre}}
                            </mat-option>
                        </mat-select>
                        <mat-error
                            *ngIf="preasignacionForm.get('espacio_academico')?.hasError('required') && preasignacionForm.get('espacio_academico')?.touched">
                            {{ 'ptd.error_espacio_academico' | translate }}
                        </mat-error>
                    </mat-form-field>
                    <div class="espacio">
                        <mat-form-field style="width: 48%;">
                            <mat-label>*{{ 'ptd.proyecto' | translate }}:</mat-label>
                            <mat-select formControlName="proyecto" (selectionChange)="changeProyecto()">
                                <mat-option>--{{ 'GLOBAL.seleccionar' | translate }}--</mat-option>
                                <mat-option *ngFor="let item of opcionesProyectos" [value]="item">
                                    {{item}}
                                </mat-option>
                            </mat-select>
                            <mat-error
                                *ngIf="preasignacionForm.get('proyecto')?.hasError('required') && preasignacionForm.get('proyecto')?.touched">
                                {{ 'ptd.error_proyecto' | translate }}
                            </mat-error>
                        </mat-form-field>
                        <mat-form-field style="width: 24%;">
                            <mat-label>{{ 'GLOBAL.nivel' | translate }}</mat-label>
                            <input matInput type="text" formControlName="nivel" readonly
                                placeholder="*{{ 'GLOBAL.nivel' | translate }}:" />
                            <mat-error
                                *ngIf="preasignacionForm.get('nivel')?.hasError('required') && preasignacionForm.get('nivel')?.touched">
                                {{ 'ptd.error_nivel' | translate }}
                            </mat-error>
                        </mat-form-field>
                        <mat-form-field style="width: 24%;">
                            <mat-label>*{{ 'asignaturas.grupo' | translate }}:</mat-label>
                            <mat-select formControlName="grupo" (selectionChange)="changeGrupo()">
                                <mat-option>--{{ 'GLOBAL.seleccionar' | translate }}--</mat-option>
                                <mat-option *ngFor="let item of opcionesGrupos" [value]="item">
                                    {{item.grupo}}
                                </mat-option>
                            </mat-select>
                            <mat-error
                                *ngIf="preasignacionForm.get('grupo')?.hasError('required') && preasignacionForm.get('grupo')?.touched">
                                {{ 'ptd.error_grupo' | translate }}
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>

                <div style="display: flex; gap: 0.5em; flex-wrap: wrap;">
                    <button mat-flat-button (click)="enviarPreasignacion()" color="accent" >{{ 'GLOBAL.crear' | translate }}</button>
                    <button mat-flat-button (click)="cancelar()">{{ 'GLOBAL.cancelar' | translate }}</button>
                </div>

        </form>
    </mat-card-content>
</mat-card>